/* Copyright (c) 2012 Dimitri del Marmol
_ ? console.log "git@github.com:ddm/-.git" : throw "depends on _.js"
µ({
  doSomething: function() {
    console.log("ok")
  }
}).before(/do./, function() {
  console.log("ready?")
}).doSomething()
µ(
  µ(document)
    .before(/Element/, function() { console.log("interception!") })
    .after(/./, function() { console.log("How many methods does window have?", µ(window).match(/./).length) })
  .getElementsByTagName('head')
).match(/./) */
function µ(e){return _.extend(Object.create(e),{match:function(e){var t=this,n=_.difference(_.functions(t),_.functions(µ(null)));return n.filter(function(t){if(_.isString(e))return t===e;if(_.isRegExp(e))return e.test(t);if(_.isFunction(e))return e(t);throw"Illegal pointcut: "+e})},before:function(e,t){var n=this,r=n.match(e);return _.each(r,function(e){var r=n[e];n[e]=function(){var e=t.apply(n,arguments);return r.apply(n,e||arguments)}}),n},after:function(e,t){var n=this,r=n.match(e);return _.each(r,function(e){var r=n[e];n[e]=function(){var e=r.apply(n,arguments);return t.apply(n,[e])||e}}),n},insteadOf:function(e,t){var n=this,r=n.match(e);return _.each(r,function(e){n[e]=function(){return t.apply(n,arguments)}}),n}})};
